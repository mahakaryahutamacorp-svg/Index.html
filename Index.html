<!-- Paste/replace whole index.html with this (or merge into current file) -->
<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rocell Gadget | Katalog Handphone</title>
  <meta name="description" content="Rocell Gadget - katalog" />
  <link rel="icon" href="rocell_gadget_logo.png" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
  <style>
    :root{--bg:#0d1117;--card:#0f1524;--muted:#91a5c6;--accent:#2563eb}
    body{background:var(--bg);color:#e6edf3}
    .navbar,.modal-content{background:#161b22}
    .card{background:var(--card);border:1px solid #23375a}
    .form-control,.form-select{background:#0b1220;color:#e6edf3;border-color:#23375a}
    .btn-primary{background:var(--accent);border-color:var(--accent)}
    .wa-btn{position:fixed;right:18px;bottom:18px;z-index:9999;border-radius:999px;padding:12px 14px}
    .logo-container{text-align:center;margin:10px 0}
    .logo-container img{max-width:160px}
    .admin-only{display:none}
  </style>
</head>
<body>
  <div class="logo-container">
    <img src="rocell_gadget_logo.png" alt="Rocell Gadget Logo" onerror="this.style.display='none'">
  </div>

  <nav class="navbar navbar-expand-lg border-bottom sticky-top py-2">
    <div class="container-fluid">
      <div class="d-flex align-items-center gap-2">
        <button class="btn btn-outline-light" id="btnViewToggle" title="Ganti tampilan">
          <i class="bi bi-list"></i> Mode: <span id="viewModeLabel">Terbuka</span>
        </button>
      </div>

      <div class="ms-auto d-flex gap-2">
        <button id="loginBtn" class="btn btn-outline-light">Login</button>
        <button id="logoutBtn" class="btn btn-danger admin-only">Logout</button>
      </div>
    </div>
  </nav>

  <main class="container py-3">
    <div class="mb-2 d-flex justify-content-between">
      <div>
        <input id="searchInput" class="form-control" placeholder="Cari nama barang..." />
      </div>
      <div>
        <button id="btnTambah" class="btn btn-primary admin-only"><i class="bi bi-plus-lg"></i> Tambah</button>
      </div>
    </div>

    <div class="card">
      <div class="card-body p-0">
        <div class="table-responsive">
          <table id="tblBarang" class="table table-hover align-middle w-100">
            <thead>
              <tr><th>Barang</th><th>Stok</th><th>Harga</th><th class="text-center">Aksi</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </main>

  <!-- Floating WA -->
  <a id="waBtn" class="btn btn-success wa-btn" href="#" target="_blank">
    <i class="bi bi-whatsapp"></i> <span class="d-none d-md-inline">Chat via WhatsApp</span>
  </a>

  <!-- Login Modal -->
  <div class="modal fade" id="loginModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">Admin Login</h5><button class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <div class="mb-2"><input id="adminPassword" type="password" class="form-control" placeholder="Masukkan password admin"></div>
          <div id="loginError" class="text-danger small" style="display:none">Password salah.</div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-outline-light" data-bs-dismiss="modal">Batal</button>
          <button id="doLogin" class="btn btn-primary">Login</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Add/Edit Modal -->
  <div class="modal fade" id="editModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header"><h5 id="editTitle" class="modal-title">Tambah Barang</h5><button class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <div class="mb-2"><label class="form-label">Nama</label><input id="mNama" class="form-control"></div>
          <div class="mb-2"><label class="form-label">Brand</label><input id="mBrand" class="form-control"></div>
          <div class="row g-2">
            <div class="col-6"><label class="form-label">Stok</label><input id="mStok" type="number" class="form-control" min="0"></div>
            <div class="col-6"><label class="form-label">Harga</label><input id="mHarga" type="number" class="form-control" min="0"></div>
          </div>
          <div class="mb-2"><label class="form-label">Gambar (URL)</label><input id="mImage" class="form-control" placeholder="https://... (opsional)"></div>
          <input type="hidden" id="mId">
        </div>
        <div class="modal-footer">
          <button class="btn btn-outline-light" data-bs-dismiss="modal">Batal</button>
          <button id="saveItem" class="btn btn-primary">Simpan</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
  (function(){
    // ----- CONFIG -----
    // Default admin password (hashed with SHA-256) - default plaintext: "rocelladmin"
    // To change password: generate SHA-256 hex of new password and replace below.
    const ADMIN_PASSWORD_HASH = 'fbc52d6d2ef95b0d37db114d3e2a76cc85ee5110e1ef3a6bb77eb8aad66ec4b8';
    const STORAGE_KEY = 'rocell_items_v1';
    const AUTH_KEY = 'rocell_admin_session';

    // ----- UTIL -----
    async function sha256Hex(str){
      const enc = new TextEncoder().encode(str);
      const buf = await crypto.subtle.digest('SHA-256', enc);
      return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
    }

    function getItems(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        return raw ? JSON.parse(raw) : [];
      }catch(e){ return []; }
    }
    function saveItems(arr){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
    }
    function isLoggedIn(){ return sessionStorage.getItem(AUTH_KEY) === '1'; }
    function setLoggedIn(v){ if(v) sessionStorage.setItem(AUTH_KEY,'1'); else sessionStorage.removeItem(AUTH_KEY); updateAdminUI(); }

    // ----- INITIAL SAMPLE DATA (only if empty) -----
    if(!localStorage.getItem(STORAGE_KEY)){
      const sample = [
        { id:'t1', brand:'Apple', nama:'Ipad Mini 2 4G 16GB', stok:1, harga:400000, image:''},
        { id:'t2', brand:'Samsung', nama:'Samsung Note 5 4/32', stok:1, harga:200000, image:''}
      ];
      saveItems(sample);
    }

    // ----- RENDER -----
    function currency(n){ return new Intl.NumberFormat('id-ID').format(n||0); }
    function render(){
      const tbody = document.querySelector('#tblBarang tbody');
      const items = getItems();
      tbody.innerHTML = '';
      items.forEach(it=>{
        const tr = document.createElement('tr');
        tr.dataset.id = it.id;
        const imgHtml = it.image ? `<img src="${it.image}" style="width:56px;height:40px;object-fit:cover;border-radius:6px;margin-right:8px">` : '';
        tr.innerHTML = `
          <td>${imgHtml}<strong>${it.brand}</strong><br>${it.nama}</td>
          <td>${it.stok} unit</td>
          <td>${it.harga>0? 'Rp '+currency(it.harga): '<span class="text-muted">Hubungi</span>'}</td>
          <td class="text-center">
            <div class="d-inline-block">
              <button class="btn btn-sm btn-success btn-wa"><i class="bi bi-whatsapp"></i></button>
            </div>
            <div class="d-inline-block admin-only ms-1">
              <button class="btn btn-sm btn-outline-light btn-edit"><i class="bi bi-pencil"></i></button>
              <button class="btn btn-sm btn-outline-danger btn-delete"><i class="bi bi-trash"></i></button>
            </div>
          </td>`;
        tbody.appendChild(tr);
      });
      updateAdminUI(); // show/hide admin-only buttons
    }

    // ----- UI helpers -----
    function updateAdminUI(){
      const blocks = document.querySelectorAll('.admin-only');
      blocks.forEach(el => el.style.display = isLoggedIn() ? '' : 'none');
      document.getElementById('loginBtn').style.display = isLoggedIn() ? 'none' : '';
      document.getElementById('logoutBtn').style.display = isLoggedIn() ? '' : 'none';
    }

    // ----- ACTIONS -----
    document.addEventListener('click', async (ev)=>{
      const tr = ev.target.closest('tr');
      if(!tr) return;
      const id = tr.dataset.id;
      if(ev.target.closest('.btn-wa')){
        const items = getItems();
        const it = items.find(x=>x.id===id);
        const msg = `Halo, saya minat ${it.brand} ${it.nama} (stok ${it.stok}).`;
        window.open(`https://wa.me/6281211172228?text=${encodeURIComponent(msg)}`,'_blank');
      } else if(ev.target.closest('.btn-edit')){
        if(!isLoggedIn()){ alert('Harus login dulu.'); return; }
        const items = getItems(); const it = items.find(x=>x.id===id);
        document.getElementById('mId').value = it.id;
        document.getElementById('mNama').value = it.nama;
        document.getElementById('mBrand').value = it.brand;
        document.getElementById('mStok').value = it.stok;
        document.getElementById('mHarga').value = it.harga;
        document.getElementById('mImage').value = it.image || '';
        document.getElementById('editTitle').textContent = 'Edit Barang';
        new bootstrap.Modal(document.getElementById('editModal')).show();
      } else if(ev.target.closest('.btn-delete')){
        if(!isLoggedIn()){ alert('Harus login dulu.'); return; }
        if(!confirm('Hapus item ini?')) return;
        let items = getItems(); items = items.filter(x=>x.id!==id); saveItems(items); render();
      }
    });

    // Save item
    document.getElementById('saveItem').addEventListener('click', ()=>{
      const id = document.getElementById('mId').value || ('id'+Date.now().toString(36));
      const nama = document.getElementById('mNama').value.trim();
      const brand = document.getElementById('mBrand').value.trim();
      const stok = parseInt(document.getElementById('mStok').value) || 0;
      const harga = parseInt(document.getElementById('mHarga').value) || 0;
      const image = document.getElementById('mImage').value.trim();
      if(!nama || !brand){ alert('Nama & Brand wajib diisi'); return; }
      let items = getItems();
      const idx = items.findIndex(x=>x.id===id);
      const payload = { id, nama, brand, stok, harga, image };
      if(idx>=0) items[idx]=payload; else items.unshift(payload);
      saveItems(items);
      bootstrap.Modal.getInstance(document.getElementById('editModal')).hide();
      render();
    });

    // Login modal actions
    document.getElementById('loginBtn').addEventListener('click', ()=> new bootstrap.Modal(document.getElementById('loginModal')).show());
    document.getElementById('doLogin').addEventListener('click', async ()=>{
      const pwd = document.getElementById('adminPassword').value||'';
      const h = await sha256Hex(pwd);
      if(h === ADMIN_PASSWORD_HASH){
        setLoggedIn(true);
        document.getElementById('adminPassword').value = '';
        document.getElementById('loginError').style.display = 'none';
        bootstrap.Modal.getInstance(document.getElementById('loginModal')).hide();
        render();
      } else {
        document.getElementById('loginError').style.display = '';
      }
    });
    document.getElementById('logoutBtn').addEventListener('click', ()=> { setLoggedIn(false); render(); });

    // search
    document.getElementById('searchInput').addEventListener('input', (ev)=>{
      const q = ev.target.value.trim().toLowerCase();
      const items = getItems().filter(it => (it.nama+' '+it.brand).toLowerCase().includes(q));
      const tbody = document.querySelector('#tblBarang tbody'); tbody.innerHTML='';
      items.forEach(it=>{
        const tr = document.createElement('tr'); tr.dataset.id=it.id;
        const imgHtml = it.image ? `<img src="${it.image}" style="width:56px;height:40px;object-fit:cover;border-radius:6px;margin-right:8px">` : '';
        tr.innerHTML = `<td>${imgHtml}<strong>${it.brand}</strong><br>${it.nama}</td><td>${it.stok} unit</td><td>${it.harga>0? 'Rp '+currency(it.harga):'<span class=text-muted>Hubungi</span>'}</td><td class="text-center"><button class="btn btn-sm btn-success btn-wa"><i class="bi bi-whatsapp"></i></button><div class="d-inline-block admin-only ms-1"><button class="btn btn-sm btn-outline-light btn-edit"><i class="bi bi-pencil"></i></button><button class="btn btn-sm btn-outline-danger btn-delete"><i class="bi bi-trash"></i></button></div></td>`;
        tbody.appendChild(tr);
      });
      updateAdminUI();
    });

    // Toggle view mode (Terbuka vs Compact). Simple behavior: just change label.
    const btnViewToggle = document.getElementById('btnViewToggle');
    btnViewToggle.addEventListener('click', ()=>{
      const label = document.getElementById('viewModeLabel');
      label.textContent = label.textContent === 'Terbuka' ? 'Compact' : 'Terbuka';
      // For demo we just change row padding for compact
      document.querySelectorAll('#tblBarang tbody tr').forEach(tr=>{
        if(label.textContent==='Compact') tr.style.padding = '2px';
        else tr.style.padding = '';
      });
    });

    // init
    function currency(n){ return new Intl.NumberFormat('id-ID').format(n||0); }
    async function sha256Hex(s){ const enc=new TextEncoder().encode(s); const h=await crypto.subtle.digest('SHA-256',enc); return Array.from(new Uint8Array(h)).map(b=>b.toString(16).padStart(2,'0')).join(''); }

    // render first time and set login state
    if(!sessionStorage.getItem(AUTH_KEY)) sessionStorage.removeItem(AUTH_KEY);
    updateAdminUI();
    render();

    // expose helper for owner (optional)
    window._rocell = {
      setAdminHash: async function(plain){ console.log('Use this value to update ADMIN_PASSWORD_HASH in source:', await sha256Hex(plain)); }
    };
  })();
  </script>
</body>
</html>
